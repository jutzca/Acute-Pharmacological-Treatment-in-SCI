group_by(indication) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(bigram, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
mutate(bigram = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication)
df_4 %>%
arrange(desc(n)) %>%
mutate(bigram = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(generic_name) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(bigram, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free")
df_4 %>%
tidytext::arrange(desc(n)) %>%
mutate(bigram = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(bigram, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free")
install.packages("tidytext")
install.packages("tidytext")
library(tidytext)
df_4 %>%
tidytext::arrange(desc(n)) %>%
mutate(bigram = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(bigram, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
tidytext::mutate(bigram = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(bigram, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
mutate(bigram = factor(generic_name, levels = rev(unique(generic_name)))) %>%
tidytext::group_by(indication) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(bigram, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
mutate(bigram = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
tidytext::top_n(10, n) %>%
ungroup %>%
ggplot(aes(bigram, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
tidytext::top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication, generic_name) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(generic_name) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(generic_name) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(~indication, ncol = 3, scales = "free", space='free')
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(generic_name) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_grid(~indication, ncol = 3, scales = "free", space='free')
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(generic_name) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_grid(.~indication, ncol = 3, scales = "free", space='free')
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(generic_name) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_grid(.~indication, ncol = 3, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(generic_name) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_grid(.~indication, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(generic_name) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_grid(.~indication, scales = "free", nrow=2)
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(generic_name) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_grid(.~indication, scales = "free")
df_4 %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(generic_name) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
df_4 %>%
arrange(desc(n))
#Count number of drugs per indication
df_3 <- dataframe_rm_duplicates %>%
dplyr::count(generic_name, indication) %>%as.data.frame()
df_3
#Count number of drugs per indication
df_3 <- dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%as.data.frame()
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
#arrange(desc(n)) %>%
#mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
arrange(desc(n)) %>%
#mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
arrange(desc(n))
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name)
#load file
dataframe <- read.csv("/Volumes/jutzelec$/8_Projects/1_Ongoing/3_Drugs/masterfile/df2_drugs_freq_disorder.csv", sep = ',', header = T)
#Remove Duplicates based on three rows
dataframe_rm_duplicates <- dataframe[!duplicated(dataframe[c(2:4)]),]
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name)
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
#arrange(desc(n)) %>%
#mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
#group_by(indication) %>%
top_n(10, n) %>%
ungroup %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
#arrange(desc(n)) %>%
#mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
#group_by(indication) %>%
top_n(10, n)
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name)
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
#arrange(desc(n)) %>%
#mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
#group_by(indication) %>%
#top_n(10, n) %>%
ggplot(aes(generic_name, n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
#arrange(desc(n)) %>%
#mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
#group_by(indication) %>%
#top_n(10, n) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
#arrange(desc(n)) %>%
#mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
#group_by(indication) %>%
top_n(10, n) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
#arrange(desc(n)) %>%
#mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
#group_by(indication) %>%
top_n(300, n) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
#arrange(desc(n)) %>%
#mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
arrange(desc(n)) %>%
#mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
df_4 <-subset(dataframe_rm_duplicates, n>20)
df_4 %>%
dplyr::count(indication, generic_name) %>%
arrange(desc(n)) %>%
mutate(generic_name = factor(generic_name, levels = rev(unique(generic_name)))) %>%
group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
df_4 <-subset(dataframe_rm_duplicates, n>20)
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
arrange(desc(n)) %>%
filter(n() >= 10)
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
arrange(desc(n)) %>%
filter(n() >= 10)
group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
arrange(desc(n)) %>%
filter(n() >= 10) %>%
group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
arrange(desc(n)) %>%
filter(n() >= 20) %>%
group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
ggplot(data=df_4, aes(x=reorder(generic_name, -n), y=n))+geom_bar(stat = "identity")+facet_wrap(.~indication, scales = "free", ncol = 3)+theme_bw()
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
arrange(desc(n)) %>%
filter(n() >= 20) %>%
group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_bar(stat = "identity")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
arrange(desc(n)) %>%
filter(n() >= 20) %>%
group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_bar(stat = "identity")+
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
filter(n() >= 20) %>%
group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_bar(stat = "identity")+
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name)
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
filter(n() >= 20)
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
filter(n>= 20) %>%
group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_bar(stat = "identity")+
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
filter(n>= 20)
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
filter(n>= 20) %>%
group_by(indication)
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
filter(n>= 20) %>%
group_by(indication, n) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_bar(stat = "identity")+
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
filter(n>= 20) %>%
arrange(desc(n)) %>%
group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_bar(stat = "identity")+
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
filter(n>= 20) %>%
arrange(desc(n)) %>%
group_by(indication)
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
filter(n>= 20) %>%
arrange(desc(n)) %>%
group_by(indication)
dfff<-dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
filter(n>= 20) %>%
arrange(desc(n))
dfff
dfff%>%
group_by(indication)
dfff%>%
dplyr::group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_bar(stat = "identity")+
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dfff%>%
dplyr::group_by(indication)
dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
dplyr::filter(n>= 20) %>%
dplyr::arrange(desc(n))
dfff<-dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
dplyr::filter(n>= 20) %>%
dplyr::arrange(desc(n))
dfff%>%
dplyr::group_by(indication)
detach(package:plyr)
dfff<-dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
dplyr::filter(n>= 20) %>%
dplyr::arrange(desc(n))%>%  as.data.frame()
dfff%>%
dplyr::group_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_bar(stat = "identity")+
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dfff%>%
dplyr::group_by(indication)
dfff%>%
dplyr::sort_by(indication)
dfff
dfff%>%
dplyr::sort_by(indication)
dfff%>%
dplyr::order_by(indication) %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_bar(stat = "identity")+
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dfff%>%
dplyr::order_by(indication)
dfff%>%
dplyr::order_by("indication") %>%
ggplot(aes(x=reorder(generic_name, -n), y=n)) +
geom_bar(stat = "identity")+
labs(x = NULL, y = "n") +
facet_wrap(.~indication, scales = "free")
dfff%>%
dplyr::order_by("indication")
dfff<-dataframe_rm_duplicates %>%
dplyr::count(indication, generic_name) %>%
dplyr::filter(n>= 20) %>%
dplyr::arrange(desc(n))%>%  as.data.frame()
dfff%>%
dplyr::order_by("indication")
